# HowToUse - 聊天用户使用指引

本指南面向在 QQ 群或私聊中与机器人互动的普通用户，帮助你快速掌握 `/nai` 生图指令的正确写法以及常见注意事项。

---

## 1. 使用前必读

1. **确认白名单**：
   - 你需要加入机器人维护者设定的用户白名单。
   - 在群聊中使用，还需该群已加入群白名单。
2. **群聊必须 @ 机器人**：在群里发指令时记得先 `@机器人`。
3. **每日次数限制**：机器人会统计你的每日使用次数，达到上限后需等待次日重置或联系管理员。

---

## 2. 触发生图

### 群聊示例
```
@机器人 /nai 正面词条:<masterpiece, best quality> 分辨率:<竖图>
```

### 私聊示例
```
/nai 正面词条:<masterpiece, best quality> 分辨率:<竖图>
```

**关键点**：
- 指令必须以 `/nai` 开头。
- 每个参数写成 `参数名:<内容>` 或 `参数名：<内容>`（中英冒号均可）。
- 尖括号 `< >` 内填写具体内容，括号不可省略。
- 参数之间可用空格、换行来分隔。
- 如果需要引用消息内的图片，请先发送图片，然后使用 `底图:<1>`、`角色参考:<2>` 等编号方式引用。

---

## 3. 常用参数速查

| 参数名 | 是否必填 | 合法范围/说明 | 默认值 |
| --- | --- | --- | --- |
| 正面词条 | ✅ 必填 | 生图提示词 | 无（缺少会报错） |
| 负面词条 | ❌ 可选 | 避免出现的元素 | 若留空，则使用配置中的 `preset_uc`（为空时回退到 Heavy 预设） |
| 是否有福瑞 | ❌ 可选 | `是`/`否`，为 **是** 时自动加入 `fur dataset` | 否 |
| 添加质量词 | ❌ 可选 | `是/否`，控制是否自动追加高质量标签；若关闭且主词条缺少 `best quality` 或 `masterpiece`，会使用配置中的 `quality_words` | 否 |
| 分辨率 | ❌ 可选 | `竖图`(832×1216) / `横图`(1216×832) / `方图`(1024×1024) | 竖图 |
| 步数 | ❌ 可选 | 1~28 的整数 | 28 |
| 指导系数 | ❌ 可选 | 0~10 的数字 | 5 |
| 重采样系数 | ❌ 可选 | 0~1 的数字 | 0 |
| 种子 | ❌ 可选 | 任意整数 | 随机 |
| 采样器 | ❌ 可选 | `k_euler`、`k_euler_ancestral`、`k_dpmpp_2m` 等 | `k_euler_ancestral` |
| 底图 | ❌ 可选 | 引用消息里的图片编号，用于图生图 | 空 |
| 底图重绘强度 | ❌ 可选 | 0~1 的数字（越大越接近文生图） | 0.7 |
| 底图加噪强度 | ❌ 可选 | 0~0.99 的数字 | 0 |
| 角色是否分区 | ❌ 可选 | `是`/`否`，为 **是** 时需填写角色相关参数 | 若角色 ≤1 个则自动否 |
| 角色{n}正面词条 | ❌ 可选 | 第 n 个角色的提示词，最多 5 个角色 | 空 |
| 角色{n}负面词条 | ❌ 可选 | 第 n 个角色的负面提示词 | 空 |
| 角色{n}位置 | ❌ 可选 | 使用 A1~E5 网格定位角色位置 | C3 |
| 角色参考 | ❌ 可选 | 引用消息中的参考图编号 | 空 |
| 角色参考强度 | ❌ 可选 | 0~1 的数字，越大越贴近参考图 | 1 |
| 是否注意原画风 | ❌ 可选 | `是`/`否` | 否 |
| 模型 | ❌ 可选 | 选择具体模型，如 `nai-diffusion-4-5-curated` | `config.yaml` 中的默认值 |

*提示：参数大小写不限，填错时机器人会返回错误提示。*

---

## 4. 综合示例

### 文生图
```
/nai 正面词条:<masterpiece, 1girl, long hair>
     负面词条:<lowres, bad hands>
     分辨率:<横图> 步数:<24> 指导系数:<6.5>
     采样器:<k_dpmpp_2s_ancestral> 添加质量词:<是>
```

### 图生图 + 角色定位
1. 先发送底图和角色参考图（例如两张图片）。
2. 接着发送：
```
@机器人 /nai 正面词条:<masterpiece, summer dress>
     底图:<1> 底图重绘强度:<0.6>
     角色是否分区:<是>
     角色1正面词条:<blue dress> 角色1位置:<B2>
     角色参考:<2> 角色参考强度:<0.8>
```

生成完成后，机器人会 @ 你并发送图片路径或图片文件；若失败，会在同一会话中提示原因。

---

## 5. 常见问题

1. **没有回应**：
   - 群聊：确认你和所在群都在白名单，并且指令中确实 @ 了机器人。
   - 私聊：确认你在白名单内且未超过每日限额。
2. **提示缺少 `/nai`**：
   - `/nai` 必须放在参数之前，中间不要插入其他字符。
3. **格式错误提示**：
   - 检查是否使用了正确的 `参数名:<内容>` 结构，尖括号不可省。
   - 数值参数需在合法范围内，例如步数 ≤ 28。
4. **达到每日限额**：
   - 等待次日自动重置，或联系管理员调整配额。
5. **想知道自己是否在白名单**：
   - 询问群管理员或机器人维护者；普通用户无法直接查阅名单。

---

## 6. 快速小贴士

- 刚开始可以只写 `正面词条` + `负面词条`，观察风格后逐渐添加更多参数。
- 角色定位时，`角色{n}位置` 对应 5×5 网格：A1 在左上角、E5 在右下角。
- 图生图时合理调整 `底图重绘强度`：数值越低越接近原图，越高越靠近文本描述。
- 不确定模型时保持默认即可；需要特定风格时再指定模型名称。

祝你玩得开心！如需更多帮助，请联系群管理员或机器人维护者。

---

## 7. 快速填写模板

复制下列文本，将 `<...>` 中的内容替换为你想要的提示词或数值，删除不需要的参数即可：

```
/nai 正面词条:<必填提示词>
     负面词条:<不需要的内容>
     分辨率:<竖图/横图/方图> 步数:<24以内整数>
     指导系数:<5.0> 重采样系数:<0>
     是否有福瑞:<否> 添加质量词:<否>
     采样器:<k_euler_ancestral>
     底图:<图片编号> 底图重绘强度:<0.7> 底图加噪强度:<0>
     角色是否分区:<否>
     角色1正面词条:<角色描述> 角色1负面词条:<角色负面> 角色1位置:<C3>
     角色参考:<图片编号> 角色参考强度:<1>
     模型:<nai-diffusion-4-5-curated>
```

*提示：保留每行开头的 `/nai` 与参数名称即可，未使用的参数整行删除，避免出现空的尖括号。*
